import{u as k,r as n,j as e,b as N,a as $}from"./index-B-DAgIDG.js";import{m as d,A as L}from"./index-DNBFdzca.js";import{i as M,g as D,S as E}from"./ScrollTrigger-BaGcfRfm.js";const z=({onClose:s,onUpdateUser:m})=>{const{user:r,setUser:x}=k(),[o,u]=n.useState({name:(r==null?void 0:r.name)||"",department:(r==null?void 0:r.department)||"",phone:(r==null?void 0:r.phone)||""}),[t,i]=n.useState(null),[a,l]=n.useState(!1),[c,h]=n.useState(null),g=[{value:"",label:"Select Department"},{value:"Full Stack",label:"Full Stack"},{value:"Frontend",label:"Frontend"},{value:"Backend",label:"Backend"},{value:"Designer",label:"Designer"},{value:"DSA",label:"DSA"}],p=f=>{const{name:j,value:v}=f.target;u(b=>({...b,[j]:v}))},y=f=>{i(f.target.files[0])},A=async f=>{var j,v;f.preventDefault(),l(!0),h(null);try{const b=localStorage.getItem("token"),w=new FormData;w.append("name",o.name),w.append("department",o.department),w.append("phone",o.phone),t&&w.append("profile",t);const C=await N.put(`http://localhost:5000/api/employee/update-profile/${r._id}`,w,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!C.data.user)throw new Error("No user data returned from server");const S={...C.data.user,token:r.token};x(S),localStorage.setItem("authUser",JSON.stringify(S)),localStorage.setItem("token",b),m&&m(S),s()}catch(b){console.error("Profile update error:",b),h(((v=(j=b.response)==null?void 0:j.data)==null?void 0:v.message)||"Failed to update profile")}finally{l(!1)}};return e.jsx(d.div,{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:e.jsxs(d.div,{className:"bg-white rounded-xl shadow-2xl w-full max-w-md overflow-hidden",initial:{scale:.95,y:20},animate:{scale:1,y:0},exit:{scale:.95,y:20},transition:{type:"spring",stiffness:300,damping:25},children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-700 p-6 text-white",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h2",{className:"text-xl font-bold flex items-center",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})}),"Update Profile"]}),e.jsx("button",{onClick:s,className:"text-white/80 hover:text-white transition-colors","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsxs("form",{onSubmit:A,className:"p-6 space-y-4",children:[c&&e.jsx(d.div,{className:"p-3 bg-red-100 text-red-700 rounded-lg text-sm",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},children:c}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name"}),e.jsx("div",{className:"relative",children:e.jsx("input",{type:"text",name:"name",value:o.name,onChange:p,required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-200 focus:border-blue-500 transition-all"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),e.jsx("select",{name:"department",value:o.department,onChange:p,className:"w-full text-black px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-200 focus:border-blue-500 transition-all",children:g.map(f=>e.jsx("option",{value:f.value,children:f.label},f.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number"}),e.jsx("input",{type:"text",name:"phone",value:o.phone,onChange:p,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-200 focus:border-blue-500 transition-all"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Profile Picture"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("label",{className:"flex-1",children:e.jsxs("div",{className:"px-4 py-2 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",children:[e.jsx("span",{className:"text-sm text-gray-700",children:"Choose file"}),e.jsx("input",{type:"file",name:"profile",accept:"image/*",onChange:y,className:"hidden"})]})}),t&&e.jsx(d.span,{className:"text-sm text-green-600",initial:{opacity:0},animate:{opacity:1},children:"Selected"})]})]}),e.jsx("div",{className:"pt-4",children:e.jsx("button",{type:"submit",disabled:a,className:`w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg transition-all flex justify-center items-center ${a?"opacity-80 cursor-not-allowed":""}`,children:a?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):"Save Changes"})})]})]})})},B=()=>{const[s,m]=n.useState([]),[r,x]=n.useState(""),[o,u]=n.useState(!0),t=async()=>{try{u(!0);const a=await M.get("/employee/tasks");m(a.data)}catch(a){console.error("Error fetching tasks:",a),x("Failed to fetch tasks")}finally{u(!1)}},i=async a=>{try{const l=localStorage.getItem("token");await M.put(`http://localhost:5000/api/employee/tasks/${a}/complete`,{},{headers:{Authorization:`Bearer ${l}`}}),m(c=>c.map(h=>h._id===a?{...h,status:"completed"}:h))}catch(l){console.error("Error marking task as completed:",l)}};return n.useEffect(()=>{t()},[]),e.jsxs("div",{className:"space-y-4",children:[r&&e.jsx(d.div,{className:"p-3 bg-red-100 text-red-700 rounded-lg text-sm",initial:{opacity:0},animate:{opacity:1},children:r}),o?e.jsx("div",{className:"flex justify-center py-8",children:e.jsxs("svg",{className:"animate-spin h-8 w-8 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}):s.length===0?e.jsxs(d.div,{className:"text-center py-8 text-gray-500",initial:{opacity:0},animate:{opacity:1},children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-12 w-12 mx-auto text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),e.jsx("p",{className:"mt-2",children:"No tasks assigned yet"})]}):e.jsx("ul",{className:"space-y-3",children:e.jsx(L,{children:s.map(a=>e.jsxs(d.li,{className:"bg-white p-4 rounded-lg shadow border border-gray-100",initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0},transition:{duration:.2},layout:!0,children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-800",children:a.title}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:a.description})]}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${a.status==="completed"?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"}`,children:a.status})]}),a.status!=="completed"&&e.jsxs(d.button,{onClick:()=>i(a._id),className:"mt-3 w-full sm:w-auto px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white text-sm rounded-lg transition-colors flex items-center justify-center space-x-1",whileHover:{scale:1.02},whileTap:{scale:.98},children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),e.jsx("span",{children:"Mark Complete"})]})]},a._id))})})]})},T=()=>{const{user:s}=k(),[m,r]=n.useState(!1),[x,o]=n.useState(""),[u,t]=n.useState(!0),[i,a]=n.useState("");n.useEffect(()=>{(async()=>{try{const h=new Date().toISOString().split("T")[0],g=await N.get(`/api/employee/attendance/check?date=${h}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(r(g.data.marked),g.data.marked&&g.data.attendance){const p=new Date(g.data.attendance.date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});a(p),o(`Attendance marked at ${p}`)}}catch(h){console.error("Error checking attendance:",h)}finally{t(!1)}})()},[s.token]);const l=async()=>{var c,h,g;try{t(!0);const p=await N.post("/api/employee/attendance",{},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});r(!0);const y=new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});a(y),o(`Attendance marked at ${y}`)}catch(p){o(((h=(c=p.response)==null?void 0:c.data)==null?void 0:h.message)||"Error marking attendance"),((g=p.response)==null?void 0:g.status)===400&&r(!0)}finally{t(!1)}};return e.jsxs("div",{className:"mt-4 text-center",children:[e.jsx("button",{onClick:l,disabled:m||u,className:`px-6 py-2 rounded-md font-semibold ${m?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700 text-white"} ${u?"animate-pulse":""}`,children:u?"Checking...":m?"âœ… Attendance Marked":"Mark Attendance"}),x&&e.jsx("p",{className:"mt-2 text-sm text-green-700",children:x})]})},F=()=>{const{user:s}=k(),[m,r]=n.useState([]),[x,o]=n.useState(!0);n.useEffect(()=>{(async()=>{try{const i=await N.get("/api/employee/employee-directory",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});r(i.data)}catch(i){console.error("Failed to fetch employees:",i)}finally{o(!1)}})()},[]);const u=t=>{if(!t)return"Never";const i=new Date,a=new Date(t),l=Math.floor((i-a)/(1e3*60));return l<1?"Just now":l<60?`${l} min ago`:l<1440?`${Math.floor(l/60)} hours ago`:`${Math.floor(l/1440)} days ago`};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 p-4 md:p-8",children:e.jsxs(d.div,{className:"max-w-4xl mx-auto bg-white rounded-xl shadow-lg overflow-hidden border border-gray-100",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-700 p-6 text-white",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Employee Directory"}),e.jsx("p",{className:"text-blue-100",children:"View your colleagues' availability"})]}),e.jsx("div",{className:"p-6",children:x?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:m.filter(t=>t._id!==s._id).map(t=>e.jsx(d.div,{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow",whileHover:{y:-3},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:t.profile||`https://ui-avatars.com/api/?name=${t.name}&background=random`,alt:`${t.name}'s profile`,className:"w-12 h-12 rounded-full object-cover border-2 border-white shadow"}),e.jsx("div",{className:`absolute -bottom-1 -right-1 w-3 h-3 rounded-full border-2 border-white ${t.isOnline?"bg-green-400 animate-pulse":"bg-gray-400"}`})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-800",children:t.name}),e.jsx("div",{className:"flex items-center mt-1",children:e.jsx("span",{className:"text-xs text-gray-500",children:t.isOnline?"Online now":`Offline (${u(t.lastActive)})`})})]})]})},t._id))})})]})})};D.registerPlugin(E);const R=()=>{const{user:s,clearUser:m}=k(),[r,x]=n.useState(!1),o=$(),u=n.useRef(),t=n.useRef(),i=n.useRef([]);n.useEffect(()=>{window.scrollTo(0,0)},[s]);const a=()=>{x(!1)},l=()=>{m(),o("/login")};return s?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 p-4 md:p-8 font-sans",children:e.jsxs(d.div,{ref:u,className:"max-w-6xl mx-auto bg-white rounded-xl shadow-lg overflow-hidden border border-gray-100",children:[e.jsx(d.div,{ref:t,className:"bg-gradient-to-r from-blue-600 to-indigo-700 p-6 text-white",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(d.img,{src:(s==null?void 0:s.profile)||`https://ui-avatars.com/api/?background=random&name=${s==null?void 0:s.name}`,alt:"Profile",className:"w-16 h-16 md:w-20 md:h-20 object-cover rounded-full cursor-pointer border-4 border-white/30 shadow-lg",onClick:()=>x(!0),whileHover:{scale:1.05,rotate:[0,5,-5,0]},transition:{duration:.5}}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-xl md:text-2xl font-bold",children:["Welcome, ",s==null?void 0:s.name]}),e.jsx("p",{className:"text-blue-100",children:(s==null?void 0:s.department)||"No department assigned"})]})]}),e.jsxs(d.button,{onClick:l,className:"mt-4 md:mt-0 px-5 py-2 bg-white/10 hover:bg-white/20 rounded-lg backdrop-blur-sm border border-white/20 flex items-center space-x-2 transition-all duration-300",whileHover:{scale:1.05},whileTap:{scale:.95},children:[e.jsx("span",{children:"Logout"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M3 3a1 1 0 00-1 1v12a1 1 0 102 0V4a1 1 0 00-1-1zm10.293 9.293a1 1 0 001.414 1.414l3-3a1 1 0 000-1.414l-3-3a1 1 0 10-1.414 1.414L14.586 9H7a1 1 0 100 2h7.586l-1.293 1.293z",clipRule:"evenodd"})})]})]})}),e.jsxs("div",{className:"p-6 md:p-8 space-y-8",children:[e.jsx(L,{children:r&&e.jsx(z,{onClose:()=>x(!1),onUpdateUser:a})}),e.jsxs("section",{ref:c=>i.current[0]=c,className:"bg-gray-50 rounded-xl p-6 shadow-inner border border-gray-200",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("h2",{className:"text-xl font-semibold text-gray-800 flex items-center",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mr-2 text-blue-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),"Your Tasks"]})}),e.jsx(B,{})]}),e.jsxs("section",{ref:c=>i.current[1]=c,className:"bg-gray-50 rounded-xl p-6 shadow-inner border border-gray-200",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("h2",{className:"text-xl font-semibold text-gray-800 flex items-center",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mr-2 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Daily Attendance"]})}),e.jsx(T,{})]}),e.jsxs("section",{ref:c=>i.current[2]=c,className:"bg-gray-50 rounded-xl p-6 shadow-inner border border-gray-200",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("h2",{className:"text-xl font-semibold text-gray-800 flex items-center",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mr-2 text-purple-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),"Team Directory"]})}),e.jsxs("div",{className:"flex flex-col space-y-4",children:[e.jsx("p",{className:"text-gray-600",children:"View your colleagues' availability and contact information"}),e.jsx(F,{})]})]})]})]})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 flex items-center justify-center",children:e.jsx("div",{className:"text-center p-8 bg-white rounded-xl shadow-lg",children:e.jsx("p",{children:"Loading user data..."})})})};export{R as default};
